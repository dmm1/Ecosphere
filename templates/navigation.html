<!--/*-->
<!-- * Copyright (c)  designbeat.at. All rights reserved.-->
<!-- * This code is part of the Ecosphere project, available at https://github.com/dmm1/ecosphere-->
<!-- * path: /templates/navigation.html-->
<!-- */-->
{% load i18n %}
<header class="navbar navbar-expand-md d-print-none">
  <div class="container-xl">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-menu"
      aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <h1 class="navbar-brand navbar-brand-autodark d-none-navbar-horizontal pe-0 pe-md-3" width="110" height="32">
      <a href="{% url 'crm:dashboard' %}">{% trans "Ecosphere" %}</a>
    </h1>
    <div class="navbar-nav flex-row order-md-last">
      <!-- <div class="nav-item d-none d-md-flex me-3">
          <div class="btn-list">
            <a href="https://github.com/tabler/tabler" class="btn" target="_blank" rel="noreferrer">
              Download SVG icon from http://tabler-icons.io/i/brand-github
              <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" /></svg>
              Source code
            </a>
            <a href="https://github.com/sponsors/codecalm" class="btn" target="_blank" rel="noreferrer">
             Download SVG icon from http://tabler-icons.io/i/heart
              <svg xmlns="http://www.w3.org/2000/svg" class="icon text-pink" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572" /></svg>
              Sponsor
            </a>
          </div>
        </div> -->


      <div class="d-none d-md-flex">

        <div class="nav-item dropdown d-none d-md-flex me-3">
          <a href="#" class="nav-link px-0" data-bs-toggle="dropdown" tabindex="-1"
            aria-label="{% trans 'Show notifications' %}" title="{% trans 'Show notifications' %}">
            <!-- Download SVG icon from http://tabler-icons.io/i/bell -->
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24"
              stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path d="M10 5a2 2 0 1 1 4 0a7 7 0 0 1 4 6v3a4 4 0 0 0 2 3h-16a4 4 0 0 0 2 -3v-3a7 7 0 0 1 4 -6" />
              <path d="M9 17v1a3 3 0 0 0 6 0v-1" />
            </svg>
            <span class="badge bg-red"></span>
          </a>
          <div class="dropdown-menu dropdown-menu-arrow dropdown-menu-end dropdown-menu-card">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Last updates</h3>
              </div>
              <div class="list-group list-group-flush list-group-hoverable">

                <div class="list-group-item">
                  <div class="row align-items-center">
                    <div class="col-auto"><span class="status-dot status-dot-animated bg-green d-block"></span></div>
                    <div class="col text-truncate">
                      <a href="#" class="text-body d-block">Test task 1</a>
                      <div class="d-block text-muted text-truncate mt-n1">
                        Updated Task 1 (#29730)
                      </div>
                    </div>
                  </div>
                </div>


              </div>
            </div>
          </div>
        </div>

        <div class="nav-item nav-item-icon dropdown">
          <a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown"
            aria-label="{% trans 'Open user menu' %}" title="{% trans 'Open user menu' %}">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="icon icon-tabler icons-tabler-outline icon-tabler-adjustments-alt">
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path d="M4 8h4v4h-4z" />
              <path d="M6 4l0 4" />
              <path d="M6 12l0 8" />
              <path d="M10 14h4v4h-4z" />
              <path d="M12 4l0 10" />
              <path d="M12 18l0 2" />
              <path d="M16 5h4v4h-4z" />
              <path d="M18 4l0 1" />
              <path d="M18 9l0 11" />
            </svg></a>
          <div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
            {% if request.user.is_staff %}
            <a class="dropdown-item" href="{% url 'admin:index' %}" aria-label="{% trans 'Admin Admin' %}"
              title="{% trans 'Admin Admin' %}">{% trans 'Admin Admin Area' %}</a>
            {% endif %}
            {% if request.user.is_staff or perms.organization.change_group or perms.organization.change_team %}
            <a class="dropdown-item" href="#" aria-label="{% trans 'Country Admin Area' %}"
              title="{% trans 'Country Admin Area' %}">{% trans 'Country Admin Area' %}</a>
            {% endif %}
            <a href="#" class="dropdown-item">{% trans "Status" %}</a>
            <a href="{% url 'accounts:profile' %}" class="dropdown-item">{% trans "Profile Settings" %}</a>
            <div class="dropdown-divider"></div>
            <a href="#" class="dropdown-item">{% trans "Site Settings" %}</a>
            <div class="dropdown-divider"></div>
            <a href="{% url 'accounts:logout' %}" class="dropdown-item">{% trans "Log Out" %}</a>
          </div>
        </div>

        <div class="nav-item">
          <!-- Link to switch to dark mode -->
          <a href="#" onclick="window.cycleTheme()" class="nav-link hide-theme-dark" title="{% trans 'Switch to dark mode' %}">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24"
              stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
            </svg>
          </a>
          <!-- Link to switch to fancy mode -->
          <a href="#" onclick="window.cycleTheme()" class="nav-link hide-theme-fancy" title="{% trans 'Switch to fancy mode' %}">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="icon icon-tabler icons-tabler-outline icon-tabler-confetti">
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path d="M4 5h2" />
              <path d="M5 4v2" />
              <path d="M11.5 4l-.5 2" />
              <path d="M18 5h2" />
              <path d="M19 4v2" />
              <path d="M15 9l-1 1" />
              <path d="M18 13l2 -.5" />
              <path d="M18 19h2" />
              <path d="M19 18v2" />
              <path d="M14 16.518l-6.518 -6.518l-4.39 9.58a1 1 0 0 0 1.329 1.329l9.579 -4.39z" />
            </svg>
          </a>
          <!-- Link to switch to light mode -->
          <a href="#" onclick="window.cycleTheme()" class="nav-link hide-theme-light" title="{% trans 'Switch to light mode' %}">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24"
              stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" />
              <path d="M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7" />
            </svg>
          </a>
        </div>



        <div class="nav-item nav-item-icon dropdown">
          <a href="#" class="nav-link px-0" id="dropdownElement" data-bs-toggle="dropdown" aria-label="Language"
            title="{% trans 'Change Language' %}">
            <!-- Download SVG icon from http://tabler-icons.io/i/world -->
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="icon icon-tabler icons-tabler-outline icon-tabler-world">
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0" />
              <path d="M3.6 9h16.8" />
              <path d="M3.6 15h16.8" />
              <path d="M11.5 3a17 17 0 0 0 0 18" />
              <path d="M12.5 3a17 17 0 0 1 0 18" />
            </svg>
          </a>
          <div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">

            <form action="{% url 'set_language' %}" method="post">
              {% csrf_token %}
              <input name="next" type="hidden" value="{{ request.path }}">
              {% get_language_info_list for LANGUAGES as languages %}
              {% for language in languages %}
              {% if language.code == 'en' %}
              <button type="submit" class="dropdown-item {% if language.code == LANGUAGE_CODE %}active{% endif %}"
                name="language" value="{{ language.code }}">
                <span class="flag flag-country-gb"></span> <span class="ms-2">{{ language.name_local }}</span>
              </button>
              {% elif language.code == 'de' %}
              <button type="submit" class="dropdown-item {% if language.code == LANGUAGE_CODE %}active{% endif %}"
                name="language" value="{{ language.code }}">
                <span class="flag flag-country-de"></span> <span class="ms-2">{{ language.name_local }}</span>
              </button>
              {% else %}
              <button type="submit" class="dropdown-item {% if language.code == LANGUAGE_CODE %}active{% endif %}"
                name="language" value="{{ language.code }}">
                <span class="flag flag-country-{{ language.code }}"></span> <span class="ms-2">{{ language.name_local
                  }}</span>
              </button>
              {% endif %}
              {% endfor %}
            </form>
          </div>
        </div>




        <div class="nav-item">
          <a href="{% url 'accounts:profile' %}" class="nav-link d-flex lh-1 text-reset p-0">
            {% if user.profile.profile_picture %}
            <span class="avatar avatar-sm"
              style="background-image: url('{{ user.profile.profile_picture.url }}');"></span>
            <div class="d-none d-xl-block ps-2">
              <div>{{ user.first_name }} {{ user.last_name }}</div>
              <div class="mt-1 small text-muted">#jobdescription</div>
            </div>
            {% else %}
            <span class="avatar avatar-sm" style="background-image: url(https://via.placeholder.com/150)"></span>
            <div class="d-none d-xl-block ps-2">
              <div>{{ user.first_name }} {{ user.last_name }}</div>
              <div class="mt-1 small text-muted">#jobdescription</div>
            </div>
            {% endif %}
          </a>



        </div>
      </div>
</header>
<header class="navbar-expand-md">
  <div class="collapse navbar-collapse" id="navbar-menu">
    <div class="navbar">
      <div class="container-xl">
        <ul class="navbar-nav">
          <li class="nav-item active">
            <a class="nav-link" href="{% url 'crm:dashboard' %}">

              <span class="nav-link-title ">
                {% trans "Dashboard" %}
              </span>
            </a>
          </li>
          {% if request.user.is_staff %}
          <li class="nav-item">
            <a class="nav-link" href="{% url 'admin:index' %}">
              <span class="nav-link-title">
                {% trans "Admin Settings" %}
              </span>
            </a>
          </li>
          {% endif %}
          {% if request.user.is_staff or perms.contact.change_contact%}
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#navbar-extra" data-bs-toggle="dropdown"
              data-bs-auto-close="outside" role="button" aria-expanded="false">
              <span class="nav-link-title">
                {% trans "Company Management" %}
              </span>
            </a>
            <div class="dropdown-menu">
              <div class="dropdown-menu-columns">
                <div class="dropdown-menu-column">
                  <a class="dropdown-item" href="/company/employee">
                    {% trans "Employees" %}
                  </a>



                  <a class="dropdown-item" href="/company/department">
                    {% trans "Departments" %}
                  </a>
                </div>
                <div class="dropdown-menu-column">
                  <a class="dropdown-item" href="/company/position">
                    {% trans "Positions" %}
                    <span class="badge badge-sm bg-green-lt text-uppercase ms-auto">{% trans "NEW" %}</span>
                  </a>

                </div>
              </div>
            </div>
          </li>
          {% endif %}
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#navbar-base" data-bs-toggle="dropdown"
              data-bs-auto-close="outside" role="button" aria-expanded="false">

              <span class="nav-link-title">
                {% trans "Business Partners" %}
              </span>
            </a>
            <div class="dropdown-menu">
              <div class="dropdown-menu-columns">
                <div class="dropdown-menu-column">
                  <a class="dropdown-item" href="{% url 'business_partner:businesspartner_list' %}">
                    {% trans "All Businesspartners" %}
                  </a>


                </div>
              </div>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{% url 'tasks:task_list' %}">
              <span class="nav-link-title">
                {% trans "Tasks and Activities" %}
              </span>
            </a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#navbar-extra" data-bs-toggle="dropdown"
              data-bs-auto-close="outside" role="button" aria-expanded="false">
              <span class="nav-link-title">
                {% trans "Contacts" %}
              </span>
            </a>
            <div class="dropdown-menu">
              <div class="dropdown-menu-columns">
                <div class="dropdown-menu-column">
                  <a class="dropdown-item" href="/contacts/?show_all=true">
                    {% trans "All Contacts" %}
                  </a>



                  <a class="dropdown-item" href="/contacts/?show_all=false">
                    {% trans "My Contacts" %}
                  </a>
                </div>
                <div class="dropdown-menu-column">
                  <a class="dropdown-item" href="{% url 'contact:contact_create' %}">
                    {% trans "Create Contact" %}
                    <span class="badge badge-sm bg-green-lt text-uppercase ms-auto">{% trans "NEW" %}</span>
                  </a>

                </div>
              </div>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#navbar-layout" data-bs-toggle="dropdown"
              data-bs-auto-close="outside" role="button" aria-expanded="false">
              <span class="nav-link-title">
                {% trans "Opportunities" %}
              </span>
            </a>
            <div class="dropdown-menu">
              <div class="dropdown-menu-columns">
                <div class="dropdown-menu-column">
                  <a class="dropdown-item" href="/opportunities/?show_all=true">
                    {% trans "All Opportunities" %}
                  </a>

                </div>
                <div class="dropdown-menu-column">
                  <a class="dropdown-item" href="/opportunities/?show_all=false">
                    {% trans "My Opportunities" %}
                  </a>

                </div>
              </div>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{% url 'crm:lead_list' %}">
              <span class="nav-link-title">
                {% trans "Leads" %}
              </span>
            </a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#navbar-help" data-bs-toggle="dropdown"
              data-bs-auto-close="outside" role="button" aria-expanded="false">
              <span
                class="nav-link-icon d-md-none d-lg-inline-block"><!-- Download SVG icon from http://tabler-icons.io/i/lifebuoy -->
                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24"
                  stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                  <path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" />
                  <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" />
                  <path d="M15 15l3.35 3.35" />
                  <path d="M9 15l-3.35 3.35" />
                  <path d="M5.65 5.65l3.35 3.35" />
                  <path d="M18.35 5.65l-3.35 3.35" />
                </svg>
              </span>
              <span class="nav-link-title">
                {% trans "Help" %}
              </span>
            </a>
            <div class="dropdown-menu">
              <a class="dropdown-item" href="#" target="_blank" rel="noopener">
                {% trans "Documentation" %}
              </a>
              <a class="dropdown-item" href="#">
                {% trans "Changelog" %}
              </a>
              <a class="dropdown-item" href="https://github.com/dmm1/ecosphere" target="_blank" rel="noopener">
                {% trans "Source code" %}
              </a>
              <a class="dropdown-item text-pink" href="https://github.com/sponsors/dmm1" target="_blank" rel="noopener">
                <!-- Download SVG icon from http://tabler-icons.io/i/heart -->
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24"
                  viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                  stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                  <path d="M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572" />
                </svg>
                {% trans "Sponsor Project" %}
              </a>
            </div>
          </li>
        </ul>
        {% block extra_styles %}
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.css" />
        <style>
          .awesomplete > ul {
            border-color: #ccc;
            max-height: 200px;
            overflow-y: auto;
          }
          
          .awesomplete > ul > li[aria-selected="true"] {
            background-color: #bde4ff;
          }
        </style>
        {% endblock %}
        
        <div class="my-2 my-md-0 flex-grow-1 flex-md-grow-0 order-first order-md-last">
          <form id="search-form" action="{% url 'search:search' %}" method="get" autocomplete="off" novalidate>
            <div class="input-group">
              <span class="input-group-text">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24"
                  height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                  stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                  <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"></path>
                  <path d="M21 21l-6 -6"></path>
                </svg>
              </span>
              <input id="search-input" type="text" name="q" value="" class="form-control" placeholder="{% trans "Search..." %}" aria-label="{% trans "Search the website" %}">
              <button class="btn btn-outline-secondary" type="submit">{% trans "Search" %}</button>
            </div>
          </form>
        </div>
        
        {% block extra_js %}
        <script src="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.js"></script>
        <script>
        document.addEventListener('DOMContentLoaded', function() {
          var searchInput = document.getElementById('search-input');
          var searchForm = document.getElementById('search-form');
          var awesomplete = new Awesomplete(searchInput);

          searchInput.addEventListener('input', function() {
            if (this.value.length < 3) {
              return;
            }

            var xhr = new XMLHttpRequest();
            xhr.open('GET', '/search/autocomplete/?q=' + this.value + '&models=contact.Contact,business_partner.BusinessPartner,company.Employee', true);
            xhr.onload = function() {
              if (this.status == 200) {
                var results = JSON.parse(this.responseText).results;
                console.log('Received results:', results);
                var names = results.map(function(result) { 
                  return result.first_name ? result.first_name + ' ' + result.last_name : result.user__first_name + ' ' + result.user__last_name;
                });
                console.log('Setting list to:', names);
                awesomplete.list = names;
              }
            };
            xhr.send();
          });

          searchInput.addEventListener('awesomplete-selectcomplete', function() {
            // Submit the form when a user selects an option
            searchForm.submit();
          });
        });
        </script>
        {% endblock %}

      </div>
    </div>
  </div>
</header>