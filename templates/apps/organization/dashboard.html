<!-- /templates/app/organization/dashboard.html -->
{% extends 'base.html' %}

{% load i18n %}

{% block title %}{% trans "Admin Dashboard" %}{% endblock %}

{% block content %}
<div class="container-xl">
    <ol class="breadcrumb" aria-label="breadcrumbs">
        <li class="breadcrumb-item">
            <a href="{% url 'organization:dashboard' %}">{% trans "Country Dashboard" %}</a>
        </li>
        <li class="breadcrumb-item active">
            {% trans "Users" %}
        </li>
    </ol>
    <br />
    {% if visits < 3 %}
    <div class="alert alert-info alert-dismissible fade show" role="alert">
        <h4 class="alert-heading">{% trans "Welcome to the Country Dashboard, " %}{{ request.user.username }}!</h4>
        <p>{% trans "This is your administrative dashboard where you can manage users, groups, and teams within your organization. Use the tabs below to navigate between different sections." %}</p>
        <hr>
        <p class="mb-0">{% trans "If you need any help, please refer to the documentation or contact support." %}</p>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {% endif %}
    <div class="card">
        <div class="card-header">
            <ul class="nav nav-tabs card-header-tabs">
                <li class="nav-item">
                    <a class="nav-link active" id="users-tab" data-bs-toggle="tab" href="#users">{% trans "Users" %}</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="groups-tab" data-bs-toggle="tab" href="#groups">{% trans "Groups" %}</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="teams-tab" data-bs-toggle="tab" href="#teams">{% trans "Teams" %}</a>
                </li>
            </ul>
        </div>
        <div class="card-body">
            <div class="tab-content">
                <div class="tab-pane fade show active" id="users">
                    <div class="table-responsive">
                    <table id="users-table" class="table table-vcenter table-hover sticky-top">
                        <thead>
                            <tr>
                                <th>{% trans "Name" %}</th>
                                <th>{% trans "Email" %}</th>
                                <th>{% trans "Account" %}</th>
                                <th>{% trans "Update" %}</th>
                                <th>{% trans "Delete" %}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for user in users %}
                            <tr>
                                <td>{{ user.username }}</td>
                                <td>{{ user.email }}</td>
                                <td><a href="{% url 'organization:user_profile' user.id %}" class="btn btn-primary btn-sm">{% trans "Visit Account" %}</a></td>
                                <td><a href="{% url 'organization:update_user' user.id %}" class="btn btn-warning btn-sm">{% trans "Update" %}</a></td>
                                <td><a href="{% url 'organization:delete_user' user.id %}" class="btn btn-danger btn-sm">{% trans "Delete" %}</a></td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="5">{% trans "No users found." %}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    </div>
                    <a href="{% url 'organization:create_user' %}" class="btn btn-primary mt-3">{% trans "Create User" %}</a>
                </div>
                <div class="tab-pane fade" id="groups">
                    <div class="table-responsive">
                    <table id="groups-table" class="table table-vcenter table-hover sticky-top">
                        <thead>
                            <tr>
                                <th>{% trans "Name" %}</th>
                                <th>{% trans "Description" %}</th>
                                <th>{% trans "Update" %}</th>
                                <th>{% trans "Delete" %}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for group in groups %}
                            <tr>
                                <td><a href="{% url 'organization:group_detail' group.id %}">{{ group.name }}</a></td>
                                <td>{{ group.description }}</td>
                                <td><a href="{% url 'organization:group_update' group.id %}" class="btn btn-warning btn-sm">{% trans "Update" %}</a></td>
                                <td><a href="{% url 'organization:group_delete' group.id %}" class="btn btn-danger btn-sm">{% trans "Delete" %}</a></td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="4">{% trans "No groups found." %}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    </div>
                    <a href="{% url 'organization:group_create' %}" class="btn btn-primary mt-3">{% trans "Create Group" %}</a>
                </div>
                <div class="tab-pane fade" id="teams">
                    <div class="table-responsive">
                    <table id="teams-table" class="table table-vcenter table-hover sticky-top">
                        <thead>
                            <tr>
                                <th>{% trans "Name" %}</th>
                                <th>{% trans "Description" %}</th>
                                <th>{% trans "Group" %}</th>
                                <th>{% trans "Update" %}</th>
                                <th>{% trans "Delete" %}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for team in teams %}
                            <tr>
                                <td><a href="{% url 'organization:team_detail' team.id %}">{{ team.name }}</a></td>
                                <td>{{ team.description }}</td>
                                <td>{{ team.group.name }}</td>
                                <td><a href="{% url 'organization:team_update' team.id %}" class="btn btn-warning btn-sm">{% trans "Update" %}</a></td>
                                <td><a href="{% url 'organization:team_delete' team.id %}" class="btn btn-danger btn-sm">{% trans "Delete" %}</a></td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="5">{% trans "No teams found." %}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    </div>
                    <a href="{% url 'organization:team_create' %}" class="btn btn-primary mt-3">{% trans "Create Team" %}</a>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
$(document).ready(function(){
    $(".nav-link").on('shown.bs.tab', function(e){
        e.preventDefault();
        var tab = $(this);
        var breadcrumb = $('.breadcrumb-item.active');
        breadcrumb.text(tab.text());
    });
});
</script>
{% endblock %}
